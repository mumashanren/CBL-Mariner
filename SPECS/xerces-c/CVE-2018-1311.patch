This patch removes the Janitor responsible for the use after free in CVE-2018-1311.
This introduces a slight memory leak, but there is no upstream fix, so this is an acceptable tradeoff
for the security given that xerces-c is not commonly used and the package is removed in Mariner 2.0.

Patch adapted from the RH fix as noted in the upstream jira bug for the issue.
https://issues.apache.org/jira/browse/XERCESC-2188

Signed-off-by: Henry Beberman <henry.beberman@microsoft.com>

diff -Naur a/src/xercesc/internal/IGXMLScanner.cpp b/src/xercesc/internal/IGXMLScanner.cpp
--- a/src/xercesc/internal/IGXMLScanner.cpp	2020-01-10 08:49:55.000000000 -0800
+++ b/src/xercesc/internal/IGXMLScanner.cpp	2022-04-18 15:48:23.799257994 -0700
@@ -1532,7 +1532,6 @@
             DTDEntityDecl* declDTD = new (fMemoryManager) DTDEntityDecl(gDTDStr, false, fMemoryManager);
             declDTD->setSystemId(sysId);
             declDTD->setIsExternal(true);
-            Janitor<DTDEntityDecl> janDecl(declDTD);
 
             // Mark this one as a throw at end
             reader->setThrowAtEnd(true);
@@ -3095,7 +3094,6 @@
     DTDEntityDecl* declDTD = new (fMemoryManager) DTDEntityDecl(gDTDStr, false, fMemoryManager);
     declDTD->setSystemId(src.getSystemId());
     declDTD->setIsExternal(true);
-    Janitor<DTDEntityDecl> janDecl(declDTD);
 
     // Mark this one as a throw at end
     newReader->setThrowAtEnd(true);
diff -Naur a/tests/scripts/MemHandlerTest1 b/tests/scripts/MemHandlerTest1
--- a/tests/scripts/MemHandlerTest1     2020-01-10 08:49:55.000000000 -0800
+++ b/tests/scripts/MemHandlerTest1     2022-04-19 00:05:22.393282061 -0700
@@ -4,4 +4,4 @@

 . ../scripts/run-test

-run_test MemHandlerTest1 pass "" tests/MemHandlerTest -v=always -n -r=2 personal.xml
+run_test MemHandlerTest1 fail "" tests/MemHandlerTest -v=always -n -r=2 personal.xml
