From 75f0e0e5f7267682674029820524d22460f498b0 Mon Sep 17 00:00:00 2001
From: davkor <david@adalogics.com>
Date: Mon, 22 Feb 2021 13:44:50 +0000
Subject: [PATCH] flb_pack: fix OSS-Fuzz issue 5076752961110016

Signed-off-by: davkor <david@adalogics.com>
---
 src/flb_pack_gelf.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/src/flb_pack_gelf.c b/src/flb_pack_gelf.c
index 9991a239410..883e489b7c4 100644
--- a/src/flb_pack_gelf.c
+++ b/src/flb_pack_gelf.c
@@ -719,8 +719,8 @@ flb_sds_t flb_msgpack_to_gelf(flb_sds_t *s, msgpack_object *o,
                 }
                 else if (v->type == MSGPACK_OBJECT_EXT) {
                     quote   = FLB_TRUE;
-                    val     = o->via.ext.ptr;
-                    val_len = o->via.ext.size;
+                    val     = v->via.ext.ptr;
+                    val_len = v->via.ext.size;
                 }
 
                 if (!val || !key) {
